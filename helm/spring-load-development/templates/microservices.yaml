{{/*
This template generates Kubernetes resources for all microservices using the common templates defined in _helpers.tpl
This eliminates code duplication and makes maintenance easier
*/}}

{{/* API Gateway */}}
{{- if .Values.apiGateway.enabled }}
{{- include "spring-load-development.microservice.deployment" (dict "componentName" "api-gateway" "config" .Values.apiGateway "context" . "needsDatabase" false) }}
{{- include "spring-load-development.microservice.service" (dict "componentName" "api-gateway" "serviceName" "api-gateway" "config" .Values.apiGateway "context" .) }}
{{- include "spring-load-development.microservice.ingress" (dict "componentName" "api-gateway" "config" .Values.apiGateway "context" .) }}
{{- end }}

{{/* Loads Service */}}
{{- if .Values.loadsService.enabled }}
{{- include "spring-load-development.microservice.deployment" (dict "componentName" "loads-service" "config" .Values.loadsService "context" . "needsDatabase" true) }}
{{- include "spring-load-development.microservice.service" (dict "componentName" "loads-service" "serviceName" "loads-service" "config" .Values.loadsService "context" .) }}
{{- end }}

{{/* Components Service */}}
{{- if .Values.componentsService.enabled }}
{{- include "spring-load-development.microservice.deployment" (dict "componentName" "components-service" "config" .Values.componentsService "context" . "needsDatabase" true) }}
{{- include "spring-load-development.microservice.service" (dict "componentName" "components-service" "serviceName" "components-service" "config" .Values.componentsService "context" .) }}
{{- end }}

{{/* Rifles Service */}}
{{- if .Values.riflesService.enabled }}
{{- include "spring-load-development.microservice.deployment" (dict "componentName" "rifles-service" "config" .Values.riflesService "context" . "needsDatabase" true) }}
{{- include "spring-load-development.microservice.service" (dict "componentName" "rifles-service" "serviceName" "rifles-service" "config" .Values.riflesService "context" .) }}
{{- end }}

{{/* MCP Server */}}
{{- if .Values.mcpServer.enabled }}
{{- include "spring-load-development.microservice.deployment" (dict "componentName" "mcp-server" "config" .Values.mcpServer "context" . "needsDatabase" false) }}
{{- include "spring-load-development.microservice.service" (dict "componentName" "mcp-server" "serviceName" "mcp-server-service" "config" .Values.mcpServer "context" .) }}
{{- end }}
