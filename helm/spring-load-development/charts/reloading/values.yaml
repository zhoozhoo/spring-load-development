# Microservices configuration
name: spring-load-development
namespace: reloading

# Image settings (registry can be overridden by parent global values)
# Note: imageTag is now managed centrally via global.versions.microservices
imageRegistry: "zhoozhoo.ca"

# OpenTelemetry Collector endpoint for microservices
otelCollector:
  grpcEndpoint: "http://otel-collector-service.observability.svc.cluster.local:4317"

# Keycloak integration
keycloak:
  baseUrl: "http://keycloak-service.keycloak.svc.cluster.local:8080"
  realm: "reloading"
  clientId: "reloading-client"
  # This secret should be created outside the chart, e.g., using a pre-install hook or manually.
  existingSecret: "keycloak-client-secret"
  namespace: keycloak

# PostgreSQL configuration
postgresql:
  namespace: postgres
  auth:
    username: user
    # This secret should be created outside the chart.
    existingSecret: "postgresql-user-password"

# Observability configuration
observability:
  namespace: observability

# API Gateway configuration
apiGateway:
  enabled: true
  replicas: 1
  
  image:
    repository: zhoozhoo.ca/spring-load-development/api-gateway
    pullPolicy: IfNotPresent
  
  service:
    type: NodePort
    port: 8080
    nodePort: 30090
  
  ingress:
    enabled: true
    annotations:
      kubernetes.io/ingress.class: nginx
    hosts:
      - host: api-gateway.local
        paths:
          - path: /
            pathType: Prefix
    tls: []
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi
  
  probes:
    liveness:
      enabled: true
      path: "/actuator/health/liveness"
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      enabled: true
      path: "/actuator/health/readiness"
      initialDelaySeconds: 15
      periodSeconds: 5
      timeoutSeconds: 5
      failureThreshold: 3

  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
  
  env: []
  
  # Pod Disruption Budget for high availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
  
  # Network Policy for zero-trust security
  networkPolicy:
    enabled: true
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# Loads Service configuration
loadsService:
  enabled: true
  replicas: 1
  
  image:
    repository: zhoozhoo.ca/spring-load-development/loads-service
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 8080
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  probes:
    liveness:
      enabled: true
      path: "/actuator/health/liveness"
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      enabled: true
      path: "/actuator/health/readiness"
      initialDelaySeconds: 15
      periodSeconds: 5
      timeoutSeconds: 5
      failureThreshold: 3

  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
  
  env: []
  
  # Pod Disruption Budget for high availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
  
  # Network Policy for zero-trust security
  networkPolicy:
    enabled: true
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# Components Service configuration
componentsService:
  enabled: true
  replicas: 1
  
  image:
    repository: zhoozhoo.ca/spring-load-development/components-service
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 8080
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  probes:
    liveness:
      enabled: true
      path: "/actuator/health/liveness"
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      enabled: true
      path: "/actuator/health/readiness"
      initialDelaySeconds: 15
      periodSeconds: 5
      timeoutSeconds: 5
      failureThreshold: 3

  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
  
  env: []
  
  # Pod Disruption Budget for high availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
  
  # Network Policy for zero-trust security
  networkPolicy:
    enabled: true
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# Rifles Service configuration
riflesService:
  enabled: true
  replicas: 1
  
  image:
    repository: zhoozhoo.ca/spring-load-development/rifles-service
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 8080
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  probes:
    liveness:
      enabled: true
      path: "/actuator/health/liveness"
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      enabled: true
      path: "/actuator/health/readiness"
      initialDelaySeconds: 15
      periodSeconds: 5
      timeoutSeconds: 5
      failureThreshold: 3

  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
  
  env: []
  
  # Pod Disruption Budget for high availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
  
  # Network Policy for zero-trust security
  networkPolicy:
    enabled: true
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# MCP Server configuration
mcpServer:
  enabled: true
  replicas: 1
  
  image:
    repository: zhoozhoo.ca/spring-load-development/mcp-server
    pullPolicy: IfNotPresent
  
  service:
    type: ClusterIP
    port: 8080
  
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 500m
      memory: 512Mi

  probes:
    liveness:
      enabled: true
      path: "/actuator/health/liveness"
      initialDelaySeconds: 30
      periodSeconds: 10
      timeoutSeconds: 5
      failureThreshold: 3
    readiness:
      enabled: true
      path: "/actuator/health/readiness"
      initialDelaySeconds: 15
      periodSeconds: 5
      timeoutSeconds: 5
      failureThreshold: 3

  hpa:
    enabled: true
    minReplicas: 1
    maxReplicas: 3
    targetCPUUtilizationPercentage: 80
  
  env: []
  
  # Pod Disruption Budget for high availability
  podDisruptionBudget:
    enabled: true
    minAvailable: 1
  
  # Network Policy for zero-trust security
  networkPolicy:
    enabled: true
  
  nodeSelector: {}
  tolerations: []
  affinity: {}

# RBAC configuration
rbac:
  create: true
  # Some libraries (e.g., informers used by service discovery) list/watch Services at cluster scope.
  # Set to false if your workloads only need namespace-scoped discovery.
  clusterScope: true
  
serviceAccount:
  create: true
  name: ""
  annotations: {}

# Security context - Applied to all pods
securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  fsGroup: 2000

# Node selector, tolerations and affinity
nodeSelector: {}
tolerations: []
affinity: {}
